{% extends "base.html" %}

{% block title %}Reports - Wheat Processing Management{% endblock %}

{% block head %}
<style>
/* Fix chart container sizing */
.chart-container {
    position: relative;
    height: 300px !important;
    width: 100% !important;
    overflow: hidden;
}

.chart-container canvas {
    max-height: 300px !important;
    height: 300px !important;
    width: 100% !important;
}

/* Ensure proper responsive layout */
.main-content {
    padding-left: 0 !important;
    margin-left: 0 !important;
}

@media (min-width: 769px) {
    .main-wrapper {
        margin-left: var(--sidebar-width, 280px) !important;
    }
    
    .main-wrapper.expanded {
        margin-left: var(--sidebar-collapsed-width, 60px) !important;
    }
}

/* Mobile-first responsive design */
@media (max-width: 768px) {
    .main-wrapper {
        margin-left: 0 !important;
    }
    
    .chart-container {
        height: 250px !important;
    }
    
    .chart-container canvas {
        max-height: 250px !important;
        height: 250px !important;
    }
}

@media (max-width: 576px) {
    .card-body .row [class*="col-"] {
        margin-bottom: 15px;
    }
    
    .btn-group {
        display: flex;
        flex-direction: column;
        gap: 10px;
        width: 100%;
    }
    
    .btn-group .btn {
        width: 100%;
        margin-bottom: 5px;
    }
    
    .table-responsive {
        font-size: 12px;
    }
    
    .progress {
        min-width: 100px;
    }
    
    .card .row > div {
        margin-bottom: 1rem;
    }
    
    /* Make custom report cards stack nicely */
    .col-md-3, .col-md-6 {
        margin-bottom: 1rem;
    }
    
    /* Adjust modal for mobile */
    .modal-xl {
        max-width: 95vw;
        margin: 1rem;
    }
    
    .modal-dialog {
        margin: 0.5rem;
    }
    
    /* Stack export buttons on mobile */
    .modal-body .mb-3 .btn {
        display: block;
        width: 100%;
        margin-bottom: 10px;
    }
    
    .chart-container {
        height: 200px !important;
    }
    
    .chart-container canvas {
        max-height: 200px !important;
        height: 200px !important;
    }
}

@media (max-width: 768px) {
    .card-header h5 {
        font-size: 1rem;
    }
    
    .card-title {
        font-size: 0.9rem;
    }
    
    /* Stack metric cards on tablets */
    .col-lg-3 {
        margin-bottom: 1rem;
    }
    
    /* Adjust chart containers for tablets */
    canvas {
        max-height: 250px !important;
    }
    
    /* Make tables more readable on tablets */
    .table-sm th,
    .table-sm td {
        padding: 0.5rem;
        font-size: 0.875rem;
    }
}

@media (max-width: 992px) {
    .col-lg-6 {
        margin-bottom: 2rem;
    }
    
    /* Adjust export options for smaller screens */
    .btn-group {
        flex-wrap: wrap;
    }
}

/* Additional responsive utilities */
.text-truncate-mobile {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

@media (max-width: 576px) {
    .text-truncate-mobile {
        max-width: 150px;
    }
}

/* Loading indicator responsive */
#loadingIndicator {
    z-index: 9999;
}

@media (max-width: 576px) {
    #loadingIndicator {
        width: 80%;
        left: 10% !important;
        transform: translateY(-50%) !important;
    }
}

/* Alert positioning for mobile */
@media (max-width: 576px) {
    .alert.position-fixed {
        left: 10px !important;
        right: 10px !important;
        top: 60px !important;
        min-width: auto !important;
        width: auto !important;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h1 class="mb-4"><i class="fas fa-chart-bar me-2"></i>Reports & Analytics</h1>
    </div>
</div>

<div class="row mb-4">
    <div class="col-lg-3 col-md-6 mb-3">
        <div class="card bg-primary">
            <div class="card-body text-white">
                <div class="d-flex justify-content-between">
                    <div>
                        <h6 class="card-title">Vehicle Status</h6>
                        <h4>{{ vehicle_stats|length }}</h4>
                    </div>
                    <i class="fas fa-truck fa-2x opacity-75"></i>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-3 col-md-6 mb-3">
        <div class="card bg-success">
            <div class="card-body text-white">
                <div class="d-flex justify-content-between">
                    <div>
                        <h6 class="card-title">Total Inventory</h6>
                        <h4>{{ "%.1f"|format(godown_inventory|sum(attribute='current_stock')) }} kg</h4>
                    </div>
                    <i class="fas fa-warehouse fa-2x opacity-75"></i>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-3 col-md-6 mb-3">
        <div class="card bg-info">
            <div class="card-body text-white">
                <div class="d-flex justify-content-between">
                    <div>
                        <h6 class="card-title">Production Orders</h6>
                        <h4>{{ production_stats|length }}</h4>
                    </div>
                    <i class="fas fa-cogs fa-2x opacity-75"></i>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-3 col-md-6 mb-3">
        <div class="card bg-warning">
            <div class="card-body text-white">
                <div class="d-flex justify-content-between">
                    <div>
                        <h6 class="card-title">Dispatches</h6>
                        <h4>{{ dispatch_stats|length }}</h4>
                    </div>
                    <i class="fas fa-shipping-fast fa-2x opacity-75"></i>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-6">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-truck me-2"></i>Vehicle Status Report</h5>
            </div>
            <div class="card-body">
                <div class="chart-container">
                    <canvas id="vehicleStatusChart"></canvas>
                </div>

                <div class="table-responsive mt-3"></div>
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th>Status</th>
                                <th>Count</th>
                                <th>Percentage</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% set total_vehicles = vehicle_stats|sum(attribute='count') %}
                            {% for stat in vehicle_stats %}
                            <tr>
                                <td>
                                    <span class="badge bg-{{ 'warning' if stat.status == 'pending' else 'info' if stat.status == 'quality_check' else 'success' if stat.status == 'approved' else 'danger' if stat.status == 'rejected' else 'secondary' }}">
                                        {{ stat.status.title() }}
                                    </span>
                                </td>
                                <td>{{ stat.count }}</td>
                                <td>{{ "%.1f"|format((stat.count / total_vehicles * 100) if total_vehicles > 0 else 0) }}%</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div class="col-lg-6">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-warehouse me-2"></i>Godown Inventory Report</h5>
            </div>
            <div class="card-body">
                <div class="chart-container">
                    <canvas id="inventoryChart"></canvas>
                </div>

                <div class="table-responsive mt-3"></div>
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th>Godown</th>
                                <th>Type</th>
                                <th>Current Stock (kg)</th>
                                <th>Capacity (kg)</th>
                                <th>Utilization</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for godown in godown_inventory %}
                            <tr>
                                <td>{{ godown.name }}</td>
                                <td>{{ godown.godown_type.name }}</td>
                                <td>{{ "%.1f"|format(godown.current_stock) }}</td>
                                <td>{{ "%.0f"|format(godown.capacity) }}</td>
                                <td>
                                    {% set utilization = (godown.current_stock / godown.capacity * 100) if godown.capacity > 0 else 0 %}
                                    <div class="progress" style="height: 15px;">
                                        <div class="progress-bar bg-{{ 'success' if utilization < 80 else 'warning' if utilization < 100 else 'danger' }}"
                                             style="width: {{ utilization }}%">
                                            {{ "%.1f"|format(utilization) }}%
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-lg-6">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-cogs me-2"></i>Production Status Report</h5>
            </div>
            <div class="card-body">
                <div class="chart-container">
                    <canvas id="productionChart"></canvas>
                </div>

                <div class="table-responsive mt-3"></div>
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th>Status</th>
                                <th>Count</th>
                                <th>Percentage</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% set total_production = production_stats|sum(attribute='count') %}
                            {% for stat in production_stats %}
                            <tr>
                                <td>
                                    <span class="badge bg-{{ 'warning' if stat.status == 'pending' else 'info' if stat.status == 'planned' else 'primary' if stat.status == 'in_progress' else 'success' }}">
                                        {{ stat.status.title() }}
                                    </span>
                                </td>
                                <td>{{ stat.count }}</td>
                                <td>{{ "%.1f"|format((stat.count / total_production * 100) if total_production > 0 else 0) }}%</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div class="col-lg-6">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-shipping-fast me-2"></i>Dispatch Status Report</h5>
            </div>
            <div class="card-body">
                <div class="chart-container">
                    <canvas id="dispatchChart"></canvas>
                </div>

                <div class="table-responsive mt-3"></div>
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th>Status</th>
                                <th>Count</th>
                                <th>Percentage</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% set total_dispatch = dispatch_stats|sum(attribute='count') %}
                            {% for stat in dispatch_stats %}
                            <tr>
                                <td>
                                    <span class="badge bg-{{ 'warning' if stat.status == 'loaded' else 'primary' if stat.status == 'in_transit' else 'success' }}">
                                        {{ stat.status.replace('_', ' ').title() }}
                                    </span>
                                </td>
                                <td>{{ stat.count }}</td>
                                <td>{{ "%.1f"|format((stat.count / total_dispatch * 100) if total_dispatch > 0 else 0) }}%</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>


<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-filter me-2"></i>Custom Reports</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3 mb-3">
                        <div class="card border-primary">
                            <div class="card-body text-center">
                                <i class="fas fa-calendar-day text-primary fa-3x mb-3"></i>
                                <h6>Date-wise Report</h6>
                                <p class="small text-muted">Filter by specific date range</p>
                                <button class="btn btn-outline-primary btn-sm" onclick="generateDateReport()">
                                    Generate
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="card border-success">
                            <div class="card-body text-center">
                                <i class="fas fa-users text-success fa-3x mb-3"></i>
                                <h6>Customer-wise Report</h6>
                                <p class="small text-muted">Orders and deliveries by customer</p>
                                <button class="btn btn-outline-success btn-sm" onclick="generateCustomerReport()">
                                    Generate
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="card border-info">
                            <div class="card-body text-center">
                                <i class="fas fa-seedling text-info fa-3x mb-3"></i>
                                <h6>Product-wise Report</h6>
                                <p class="small text-muted">Production and sales by product</p>
                                <button class="btn btn-outline-info btn-sm" onclick="generateProductReport()">
                                    Generate
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="card border-warning">
                            <div class="card-body text-center">
                                <i class="fas fa-truck text-warning fa-3x mb-3"></i>
                                <h6>Vehicle-wise Report</h6>
                                <p class="small text-muted">Performance by vehicle and driver</p>
                                <button class="btn btn-outline-warning btn-sm" onclick="generateVehicleReport()">
                                    Generate
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row mt-4">
                    <div class="col-md-6 mb-3">
                        <div class="card border-secondary">
                            <div class="card-body text-center">
                                <i class="fas fa-user-tie text-secondary fa-3x mb-3"></i>
                                <h6>Salesman Performance</h6>
                                <p class="small text-muted">Orders brought by each salesman</p>
                                <button class="btn btn-outline-secondary btn-sm" onclick="generateSalesmanReport()">
                                    Generate Report
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="card border-dark">
                            <div class="card-body text-center">
                                <i class="fas fa-clipboard-list text-dark fa-3x mb-3"></i>
                                <h6>Order-wise Report</h6>
                                <p class="small text-muted">Complete order lifecycle tracking</p>
                                <button class="btn btn-outline-dark btn-sm" onclick="generateOrderReport()">
                                    Generate Report
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-download me-2"></i>Export Options</h5>
            </div>
            <div class="card-body">
                <p class="text-muted">Export data in various formats for external analysis</p>
                <div class="btn-group" role="group">
                    <button type="button" class="btn btn-outline-primary" onclick="exportToExcel()">
                        <i class="fas fa-file-excel me-2"></i>Export to Excel
                    </button>
                    <button type="button" class="btn btn-outline-secondary" onclick="exportToPDF()">
                        <i class="fas fa-file-pdf me-2"></i>Export to PDF
                    </button>
                    <button type="button" class="btn btn-outline-info" onclick="exportToCSV()">
                        <i class="fas fa-file-csv me-2"></i>Export to CSV
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Vehicle Status Chart
    const vehicleCtx = document.getElementById('vehicleStatusChart').getContext('2d');
    const vehicleData = {
        labels: [
            {% for stat in vehicle_stats %}
            '{{ stat.status.title() }}',
            {% endfor %}
        ],
        datasets: [{
            data: [
                {% for stat in vehicle_stats %}
                {{ stat.count }},
                {% endfor %}
            ],
            backgroundColor: [
                '#FFC107', // Pending - Warning
                '#17A2B8', // Quality Check - Info
                '#28A745', // Approved - Success
                '#DC3545', // Rejected - Danger
                '#6C757D'  // Other - Secondary
            ]
        }]
    };

    new Chart(vehicleCtx, {
        type: 'doughnut',
        data: vehicleData,
        options: {
            responsive: true,
            maintainAspectRatio: false,
            aspectRatio: 1,
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: {
                        boxWidth: 12,
                        padding: 10,
                        font: {
                            size: 11
                        }
                    }
                }
            },
            layout: {
                padding: 10
            },
            onResize: function(chart, size) {
                chart.canvas.style.height = '300px';
                chart.canvas.style.maxHeight = '300px';
            }
        }
    });

    // Inventory Chart
    const inventoryCtx = document.getElementById('inventoryChart').getContext('2d');
    const inventoryData = {
        labels: [
            {% for godown in godown_inventory %}
            '{{ godown.name }}',
            {% endfor %}
        ],
        datasets: [{
            label: 'Current Stock (kg)',
            data: [
                {% for godown in godown_inventory %}
                {{ godown.current_stock }},
                {% endfor %}
            ],
            backgroundColor: 'rgba(54, 162, 235, 0.8)',
            borderColor: 'rgba(54, 162, 235, 1)',
            borderWidth: 1
        }]
    };

    new Chart(inventoryCtx, {
        type: 'bar',
        data: inventoryData,
        options: {
            responsive: true,
            maintainAspectRatio: false,
            aspectRatio: 1.5,
            scales: {
                y: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'Stock (kg)'
                    }
                },
                x: {
                    ticks: {
                        maxRotation: 45,
                        minRotation: 0
                    }
                }
            },
            plugins: {
                legend: {
                    display: false
                }
            },
            layout: {
                padding: 10
            },
            onResize: function(chart, size) {
                chart.canvas.style.height = '300px';
                chart.canvas.style.maxHeight = '300px';
            }
        }
    });

    // Production Chart
    const productionCtx = document.getElementById('productionChart').getContext('2d');
    const productionData = {
        labels: [
            {% for stat in production_stats %}
            '{{ stat.status.title() }}',
            {% endfor %}
        ],
        datasets: [{
            data: [
                {% for stat in production_stats %}
                {{ stat.count }},
                {% endfor %}
            ],
            backgroundColor: [
                '#FFC107', // Pending - Warning
                '#17A2B8', // Planned - Info
                '#007BFF', // In Progress - Primary
                '#28A745'  // Completed - Success
            ]
        }]
    };

    new Chart(productionCtx, {
        type: 'pie',
        data: productionData,
        options: {
            responsive: true,
            maintainAspectRatio: false,
            aspectRatio: 1,
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: {
                        boxWidth: 12,
                        padding: 10,
                        font: {
                            size: 11
                        }
                    }
                }
            },
            layout: {
                padding: 10
            },
            onResize: function(chart, size) {
                chart.canvas.style.height = '300px';
                chart.canvas.style.maxHeight = '300px';
            }
        }
    });

    // Dispatch Chart
    const dispatchCtx = document.getElementById('dispatchChart').getContext('2d');
    const dispatchData = {
        labels: [
            {% for stat in dispatch_stats %}
            '{{ stat.status.replace("_", " ").title() }}',
            {% endfor %}
        ],
        datasets: [{
            data: [
                {% for stat in dispatch_stats %}
                {{ stat.count }},
                {% endfor %}
            ],
            backgroundColor: [
                '#FFC107', // Loaded - Warning
                '#007BFF', // In Transit - Primary
                '#28A745'  // Delivered - Success
            ]
        }]
    };

    new Chart(dispatchCtx, {
        type: 'doughnut',
        data: dispatchData,
        options: {
            responsive: true,
            maintainAspectRatio: false,
            aspectRatio: 1,
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: {
                        boxWidth: 12,
                        padding: 10,
                        font: {
                            size: 11
                        }
                    }
                }
            },
            layout: {
                padding: 10
            },
            onResize: function(chart, size) {
                chart.canvas.style.height = '300px';
                chart.canvas.style.maxHeight = '300px';
            }
        }
    });
});

// Report generation functions
function generateDateReport() {
    const startDate = prompt("Enter start date (YYYY-MM-DD):");
    const endDate = prompt("Enter end date (YYYY-MM-DD):");
    if (startDate && endDate) {
        showLoading("Generating date-wise report...");
        // For now, use order report with date filtering
        generateReport('order', `Date Range: ${startDate} to ${endDate}`);
    }
}

function generateCustomerReport() {
    showLoading("Generating customer-wise report...");
    generateReport('customer', 'Customer Performance Report');
}

function generateProductReport() {
    showLoading("Generating product-wise report...");
    generateReport('product', 'Product Performance Report');
}

function generateVehicleReport() {
    showLoading("Generating vehicle-wise report...");
    generateReport('vehicle', 'Vehicle Performance Report');
}

function generateSalesmanReport() {
    showLoading("Generating salesman performance report...");
    generateReport('salesman', 'Salesman Performance Report');
}

function generateOrderReport() {
    showLoading("Generating order-wise report...");
    generateReport('order', 'Order Lifecycle Report');
}

function generateReport(reportType, title) {
    const endpoint = `/report/${reportType}-wise`.replace('-wise', '');
    
    fetch(endpoint)
        .then(response => response.json())
        .then(data => {
            hideLoading();
            if (data.success) {
                displayReportData(data.data, title, reportType);
            } else {
                showError('Error generating report: ' + data.error);
            }
        })
        .catch(error => {
            hideLoading();
            showError('Error generating report: ' + error.message);
        });
}

function displayReportData(data, title, reportType) {
    // Create modal to display report
    const modal = document.createElement('div');
    modal.className = 'modal fade';
    modal.id = 'reportModal';
    modal.innerHTML = `
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${title}</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <button class="btn btn-primary me-2" onclick="exportReport('${reportType}', 'pdf')">
                            <i class="fas fa-file-pdf me-1"></i>Export PDF
                        </button>
                        <button class="btn btn-success" onclick="exportReport('${reportType}', 'csv')">
                            <i class="fas fa-file-csv me-1"></i>Export CSV
                        </button>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-striped table-bordered">
                            ${generateTableFromData(data)}
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    `;
    
    // Remove existing modal if any
    const existingModal = document.getElementById('reportModal');
    if (existingModal) {
        existingModal.remove();
    }
    
    document.body.appendChild(modal);
    const bootstrapModal = new bootstrap.Modal(modal);
    bootstrapModal.show();
    
    // Cleanup when modal is hidden
    modal.addEventListener('hidden.bs.modal', function () {
        modal.remove();
    });
}

function generateTableFromData(data) {
    if (!data || data.length === 0) {
        return '<tbody><tr><td colspan="100%" class="text-center">No data available</td></tr></tbody>';
    }
    
    const headers = Object.keys(data[0]);
    let html = '<thead class="table-dark"><tr>';
    
    headers.forEach(header => {
        html += `<th>${header.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase())}</th>`;
    });
    html += '</tr></thead><tbody>';
    
    data.forEach(row => {
        html += '<tr>';
        headers.forEach(header => {
            let value = row[header];
            if (typeof value === 'object' && value !== null) {
                value = JSON.stringify(value);
            } else if (value === null || value === undefined) {
                value = '-';
            }
            html += `<td>${value}</td>`;
        });
        html += '</tr>';
    });
    
    html += '</tbody>';
    return html;
}

function exportReport(reportType, format) {
    const url = `/export/${reportType}/${format}`;
    window.open(url, '_blank');
}

// Export functions
function exportToExcel() {
    showInfo("Excel export coming soon! Use CSV export for now.");
}

function exportToPDF() {
    showInfo("Please generate a specific report first, then use the Export PDF button in the report modal.");
}

function exportToCSV() {
    showInfo("Please generate a specific report first, then use the Export CSV button in the report modal.");
}

// Utility functions
function showLoading(message) {
    // Create or update loading indicator
    let loadingDiv = document.getElementById('loadingIndicator');
    if (!loadingDiv) {
        loadingDiv = document.createElement('div');
        loadingDiv.id = 'loadingIndicator';
        loadingDiv.className = 'position-fixed top-50 start-50 translate-middle';
        loadingDiv.innerHTML = `
            <div class="text-center">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <div class="mt-2 text-primary">Loading...</div>
            </div>
        `;
        document.body.appendChild(loadingDiv);
    }
    loadingDiv.querySelector('.text-primary').textContent = message;
    loadingDiv.style.display = 'block';
}

function hideLoading() {
    const loadingDiv = document.getElementById('loadingIndicator');
    if (loadingDiv) {
        loadingDiv.style.display = 'none';
    }
}

function showError(message) {
    const alertDiv = document.createElement('div');
    alertDiv.className = 'alert alert-danger alert-dismissible fade show position-fixed';
    alertDiv.style.cssText = 'top: 20px; right: 20px; z-index: 1050; min-width: 300px;';
    alertDiv.innerHTML = `
        ${message}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    `;
    document.body.appendChild(alertDiv);
    
    setTimeout(() => {
        if (alertDiv.parentNode) {
            alertDiv.remove();
        }
    }, 5000);
}

function showInfo(message) {
    const alertDiv = document.createElement('div');
    alertDiv.className = 'alert alert-info alert-dismissible fade show position-fixed';
    alertDiv.style.cssText = 'top: 20px; right: 20px; z-index: 1050; min-width: 300px;';
    alertDiv.innerHTML = `
        ${message}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    `;
    document.body.appendChild(alertDiv);
    
    setTimeout(() => {
        if (alertDiv.parentNode) {
            alertDiv.remove();
        }
    }, 5000);
}
</script>
{% endblock %}